# AI Chat æ¶æ„åˆ†æä¸ assistant-ui é›†æˆæ–¹æ¡ˆ

## ğŸ“‹ å½“å‰å®ç°åˆ†æ

### ç°æœ‰æ¶æ„

**å½“å‰å®ç°**: `EnhancedAIChat.tsx` - **ä¸æ˜¯**åŸºäº assistant-uiï¼Œè€Œæ˜¯è‡ªå®šä¹‰çš„Reactç»„ä»¶

```typescript
// å½“å‰æ¶æ„
components/EnhancedAIChat.tsx (React ç»„ä»¶)
    â†“
app/api/ai/mastra-stream/route.ts (API è·¯ç”±)
    â†“
lib/mastra/agents/fund-advisor.ts (Mastra Agent)
```

### æŠ€æœ¯æ ˆ

| å±‚çº§ | æŠ€æœ¯ | è¯´æ˜ |
|------|------|------|
| UIå±‚ | è‡ªå®šä¹‰Reactç»„ä»¶ | æ‰‹åŠ¨ç®¡ç†çŠ¶æ€ã€æµå¼å“åº” |
| APIå±‚ | Next.js API Routes | è‡ªå®šä¹‰SSEæµå¼å¤„ç† |
| Agentå±‚ | Mastra v1.1.0 | GLM-4.5-Air æ¨¡å‹ |
| å·¥å…·å±‚ | 7ä¸ªåˆ†æå·¥å…· | åŸºé‡‘æœç´¢ã€ç»„åˆåˆ†æã€å¸‚åœºæ¦‚å†µç­‰ |

### å½“å‰ç‰¹æ€§

âœ… **å·²å®ç°åŠŸèƒ½**:
- æµå¼å“åº”
- èŠå¤©å†å²ç®¡ç†
- æ™ºèƒ½å»ºè®®ç³»ç»Ÿ
- å·¥å…·è°ƒç”¨å±•ç¤º
- Markdownæ¸²æŸ“
- å¤šçª—å£å°ºå¯¸æ”¯æŒ
- ä¼šè¯ç®¡ç†

âŒ **ç¼ºå¤±åŠŸèƒ½** (ç›¸æ¯”assistant-ui):
- è‡ªåŠ¨é‡è¯•æœºåˆ¶
- è¯­éŸ³è¾“å…¥
- æ–‡ä»¶é™„ä»¶
- å†…è”å·¥å…·å®¡æ‰¹
- å‰ç«¯å·¥å…·è°ƒç”¨
- çº¿ç¨‹ç®¡ç†
- äº‘ç«¯æŒä¹…åŒ–

## ğŸ¯ assistant-ui ç®€ä»‹

### ä»€ä¹ˆæ˜¯ assistant-uiï¼Ÿ

[**assistant-ui**](https://github.com/assistant-ui/assistant-ui) æ˜¯ä¸€ä¸ªå¼€æºçš„ TypeScript/React åº“ï¼Œç”¨äºå¿«é€Ÿæ„å»ºç”Ÿäº§çº§ AI èŠå¤©ç•Œé¢ã€‚

### æ ¸å¿ƒç‰¹æ€§

- **å¼€ç®±å³ç”¨**: é¢„æ„å»ºçš„èŠå¤©ç•Œé¢ï¼Œå¿«é€Ÿè¿­ä»£
- **èŠå¤©çŠ¶æ€ç®¡ç†**: ä¸“ä¸ºæµå¼å“åº”ä¼˜åŒ–çš„çŠ¶æ€ç®¡ç†
- **é«˜æ€§èƒ½**: æœ€å°åŒ–bundleå¤§å°ï¼Œä¿æŒå“åº”æ€§
- **æ¡†æ¶æ— å…³**: æ”¯æŒä»»ä½•åç«¯ç³»ç»Ÿ
- **ä¼ä¸šçº§**: å¯é€‰çš„èŠå¤©å†å²å’Œåˆ†æ

### æ”¯æŒçš„åç«¯

- âœ… **Vercel AI SDK** (é€šè¿‡ `@assistant-ui/react-ai-sdk`)
- âœ… **LangGraph** (é€šè¿‡ LangChain providers)
- âœ… **Mastra** (æ¨¡å‹è·¯ç”±é€šè¿‡ Vercel AI SDK)
- âœ… **è‡ªå®šä¹‰** (è‡ªå·±çš„åç«¯/æµå¼åè®®)

### å®˜æ–¹é›†æˆåŒ…

```bash
# æ ¸å¿ƒåŒ…
@assistant-ui/react
@assistant-ui/react-ai-sdk  # Vercel AI SDK é€‚é…å™¨

# å¯é€‰ä¸»é¢˜
@assistant-ui/shadcn        # shadcn/ui ä¸»é¢˜
```

## ğŸ”— Mastra + assistant-ui é›†æˆ

### é›†æˆæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Frontend (React/Next.js)            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  @assistant-ui/react (UI Components)        â”‚
â”‚  @assistant-ui/react-ai-sdk (Runtime)       â”‚
â”‚  @assistant-ui/shadcn (Theme)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â†“ (Vercel AI SDK)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         API Layer (Next.js API Routes)      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Vercel AI SDK stream()                    â”‚
â”‚  Mastra Agent.generate()                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Mastra Agent Layer                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Agent + Tools (searchFunds, etc.)          â”‚
â”‚  GLM Model Router                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å·²çŸ¥é›†æˆé—®é¢˜

æ ¹æ® [GitHub Issue #2098](https://github.com/assistant-ui/assistant-ui/issues/2098):

**é—®é¢˜**: `Cannot use 'in' operator to search for 'input' in null`

**åŸå› **: assistant-ui å’Œ Mastra ä¹‹é—´çš„æ¶ˆæ¯æ ¼å¼ä¸åŒ¹é…

**çŠ¶æ€**: å·²å…³é—­ (é€šè¿‡ PR #2203 ä¿®å¤)

### é›†æˆæŒ‘æˆ˜

1. **æ¶ˆæ¯æ ¼å¼å·®å¼‚**: Mastra çš„æ¶ˆæ¯æ ¼å¼å¯èƒ½ä¸ assistant-ui æœŸæœ›çš„æ ¼å¼ä¸åŒ
2. **å·¥å…·è°ƒç”¨å¤„ç†**: éœ€è¦é€‚é… Mastra çš„å·¥å…·è°ƒç”¨æ ¼å¼åˆ° assistant-ui çš„ç»„ä»¶æ¸²æŸ“
3. **æµå¼å“åº”å…¼å®¹æ€§**: ç¡®ä¿ä¸¤ç«¯çš„æµå¼åè®®å…¼å®¹

## ğŸ“¦ æ¨èçš„é›†æˆæ–¹æ¡ˆ

### æ–¹æ¡ˆ A: å®Œæ•´é›†æˆ assistant-ui

**ä¼˜åŠ¿**:
- å¼€ç®±å³ç”¨çš„ä¼ä¸šçº§ UI
- æŒç»­æ›´æ–°å’Œç»´æŠ¤
- ä¸°å¯Œçš„ç»„ä»¶åº“
- ç¤¾åŒºæ”¯æŒ

**åŠ£åŠ¿**:
- éœ€è¦é‡æ„ç°æœ‰ä»£ç 
- é›†æˆå¤æ‚åº¦è¾ƒé«˜
- å¯èƒ½éœ€è¦é€‚é…å±‚

**å®æ–½æ­¥éª¤**:

1. **å®‰è£…ä¾èµ–**
```bash
npm install @assistant-ui/react @assistant-ui/react-ai-sdk @assistant-ui/shadcn
npm install ai @ai-sdk/react
```

2. **åˆ›å»º API è·¯ç”±é€‚é…å™¨**
```typescript
// app/api/chat/route.ts
import { mastraAgent } from '@/lib/mastra/agent';
import { streamText } from 'ai';

export async function POST(req: Request) {
  const { messages } = await req.json();

  const result = streamText({
    model: mastraAgent,  // æˆ–é€šè¿‡è·¯ç”±åˆ°å…·ä½“æ¨¡å‹
    messages,
  });

  return result.toAIStreamResponse();
}
```

3. **ä½¿ç”¨ assistant-ui ç»„ä»¶**
```typescript
// components/AIChat.tsx
import { useChatRuntime } from '@assistant-ui/react-ai-sdk';
import { AssistantModal } from '@assistant-ui/react';

export function AIChat() {
  const runtime = useChatRuntime({
    api: '/api/chat',
  });

  return <AssistantModal runtime={runtime} />;
}
```

### æ–¹æ¡ˆ B: ä¿ç•™å½“å‰å®ç°ï¼Œå¢å¼ºåŠŸèƒ½

**ä¼˜åŠ¿**:
- æ— éœ€å¤§è§„æ¨¡é‡æ„
- ä¿æŒç°æœ‰æ¶æ„
- æ¸è¿›å¼æ”¹è¿›

**åŠ£åŠ¿**:
- éœ€è¦æ‰‹åŠ¨ç»´æŠ¤
- ç¼ºå°‘é«˜çº§åŠŸèƒ½
- ç¤¾åŒºæ”¯æŒæœ‰é™

**æ”¹è¿›æ–¹å‘**:

1. æ·»åŠ è‡ªåŠ¨é‡è¯•æœºåˆ¶
2. å®ç°è¯­éŸ³è¾“å…¥
3. æ”¯æŒæ–‡ä»¶é™„ä»¶
4. æ”¹è¿›å·¥å…·è°ƒç”¨ UI
5. ä¼˜åŒ–æ€§èƒ½

### æ–¹æ¡ˆ C: æ··åˆæ–¹æ¡ˆ (æ¨è)

**ç­–ç•¥**:
- ä¿ç•™æ ¸å¿ƒ Mastra Agent æ¶æ„
- ä½¿ç”¨ Vercel AI SDK ä½œä¸ºé€‚é…å±‚
- é‡‡ç”¨ assistant-ui çš„ UI ç»„ä»¶å’Œæ¨¡å¼

**ä¼˜åŠ¿**:
- å……åˆ†åˆ©ç”¨ Mastra çš„å·¥å…·ç³»ç»Ÿ
- è·å¾—æ›´å¥½çš„ UI/UX
- é™ä½é›†æˆå¤æ‚åº¦

**å®æ–½æ­¥éª¤**:

1. **æ·»åŠ  Vercel AI SDK é€‚é…å±‚**
```typescript
// lib/mastra/ai-sdk-adapter.ts
import { mastraAgent } from './agents/fund-advisor';
import { streamText } from 'ai';

export function createMastraStream() {
  return streamText({
    model: async (params) => {
      // å°† Vercel AI SDK è°ƒç”¨è½¬æ¢ä¸º Mastra Agent è°ƒç”¨
      const response = await mastraAgent.generate(params.messages);
      return response;
    },
    tools: mastraAgent.getTools(), // è½¬æ¢å·¥å…·æ ¼å¼
  });
}
```

2. **ä½¿ç”¨ assistant-ui çš„ç»„ä»¶æ¨¡å¼**
```typescript
// ä¿ç•™å½“å‰çš„æ¶ˆæ¯ç®¡ç†ï¼Œä½†é‡‡ç”¨ assistant-ui çš„ç»„ä»¶ç»“æ„
import { MessageList, MessageInput, ThreadWelcome } from '@assistant-ui/react';
```

## ğŸ¨ UI/UX æ”¹è¿›å»ºè®®

### å½“å‰å¯æ”¹è¿›çš„ç‚¹

1. **å·¥å…·è°ƒç”¨å±•ç¤º**
   - å½“å‰: ç®€å•çš„æ–‡æœ¬æ˜¾ç¤º "ğŸ”§ ä½¿ç”¨å·¥å…·è·å–æ•°æ®..."
   - æ”¹è¿›: ä½¿ç”¨å¯æŠ˜å çš„å·¥å…·è°ƒç”¨å¡ç‰‡ï¼Œæ˜¾ç¤ºå‚æ•°å’Œç»“æœ

2. **æµå¼å“åº”ä½“éªŒ**
   - å½“å‰: åŸºç¡€æµå¼
   - æ”¹è¿›: æ·»åŠ æ‰“å­—æœºæ•ˆæœã€æ€è€ƒçŠ¶æ€æŒ‡ç¤ºå™¨

3. **æ¶ˆæ¯æ“ä½œ**
   - å½“å‰: æ— 
   - æ”¹è¿›: å¤åˆ¶ã€é‡æ–°ç”Ÿæˆã€ç¼–è¾‘æ¶ˆæ¯

4. **æœç´¢å’Œè¿‡æ»¤**
   - å½“å‰: åŸºç¡€ä¼šè¯ç®¡ç†
   - æ”¹è¿›: æ¶ˆæ¯æœç´¢ã€ä¼šè¯åˆ†ç»„

## ğŸ“Š æŠ€æœ¯å¯¹æ¯”

| ç‰¹æ€§ | å½“å‰å®ç° | assistant-ui |
|------|----------|--------------|
| æµå¼å“åº” | âœ… | âœ… |
| èŠå¤©å†å² | âœ… è‡ªå®šä¹‰ | âœ… å¯é€‰äº‘ç«¯ |
| å·¥å…·è°ƒç”¨ | âœ… åŸºç¡€æ˜¾ç¤º | âœ… ç»„ä»¶æ¸²æŸ“ |
| é‡è¯•æœºåˆ¶ | âŒ | âœ… |
| è¯­éŸ³è¾“å…¥ | âŒ | âœ… |
| æ–‡ä»¶é™„ä»¶ | âŒ | âœ… |
| ä¸»é¢˜ç³»ç»Ÿ | âœ… è‡ªå®šä¹‰ | âœ… shadcn/ui |
| çº¿ç¨‹ç®¡ç† | âœ… åŸºç¡€ | âœ… é«˜çº§ |
| æ€§èƒ½ä¼˜åŒ– | âš ï¸ åŸºç¡€ | âœ… ä¼˜åŒ– |
| å¯è®¿é—®æ€§ | âš ï¸ æœ‰é™ | âœ… å®Œæ•´ |
| ç¤¾åŒºæ”¯æŒ | âš ï¸ è‡ªç»´æŠ¤ | âœ… æ´»è·ƒ |

## ğŸš€ å®æ–½è®¡åˆ’

### ç¬¬ä¸€é˜¶æ®µ: è¯„ä¼°å’Œå‡†å¤‡ (1-2å¤©)

- [ ] æ·±å…¥ç ”ç©¶ assistant-ui æ–‡æ¡£
- [ ] åˆ†æç°æœ‰ä»£ç ç»“æ„
- [ ] ç¡®å®šé›†æˆæ–¹æ¡ˆ (A/B/C)
- [ ] åˆ›å»ºæµ‹è¯•ç¯å¢ƒ

### ç¬¬äºŒé˜¶æ®µ: åŸå‹å¼€å‘ (3-5å¤©)

- [ ] å®ç°åŸºç¡€é›†æˆ
- [ ] é€‚é… Mastra Agent
- [ ] æµ‹è¯•æµå¼å“åº”
- [ ] éªŒè¯å·¥å…·è°ƒç”¨

### ç¬¬ä¸‰é˜¶æ®µ: åŠŸèƒ½å®Œå–„ (5-7å¤©)

- [ ] å®ç°é«˜çº§åŠŸèƒ½ (é‡è¯•ã€è¯­éŸ³ç­‰)
- [ ] ä¼˜åŒ– UI/UX
- [ ] æ€§èƒ½æµ‹è¯•å’Œä¼˜åŒ–
- [ ] æ–‡æ¡£ç¼–å†™

### ç¬¬å››é˜¶æ®µ: éƒ¨ç½²å’Œç›‘æ§ (2-3å¤©)

- [ ] ç°åº¦å‘å¸ƒ
- [ ] ç›‘æ§é”™è¯¯å’Œæ€§èƒ½
- [ ] æ”¶é›†ç”¨æˆ·åé¦ˆ
- [ ] è¿­ä»£æ”¹è¿›

## ğŸ“š å‚è€ƒèµ„æº

### å®˜æ–¹æ–‡æ¡£
- [assistant-ui å®˜æ–¹æ–‡æ¡£](https://www.assistant-ui.com/docs)
- [assistant-ui GitHub](https://github.com/assistant-ui/assistant-ui)
- [Mastra å®˜æ–¹æ–‡æ¡£](https://mastra.ai/docs)
- [Vercel AI SDK æ–‡æ¡£](https://sdk.vercel.ai/docs)

### é›†æˆç¤ºä¾‹
- [GitHub Issue #2098 - Mastra é›†æˆé—®é¢˜](https://github.com/assistant-ui/assistant-ui/issues/2098)
- [Building Teacher Search Agent with Mastra](https://dev.to/meijin/building-a-teacher-search-ai-agent-with-mastra-and-structured-data-streaming-455b)
- [Agentic RAG with Mastra and Elasticsearch](https://www.elastic.co/search-labs/cn/blog/agentic-rag)

### ç¤¾åŒºèµ„æº
- [assistant-ui Discord](https://discord.gg/assistant-ui)
- [Mastra GitHub](https://github.com/mastra-ai/mastra)

## ğŸ¤” å»ºè®®

åŸºäºå½“å‰é¡¹ç›®çŠ¶æ€ï¼Œå»ºè®®é‡‡ç”¨ **æ–¹æ¡ˆ C (æ··åˆæ–¹æ¡ˆ)**:

1. **ä¿ç•™** Mastra Agent å’Œå·¥å…·ç³»ç»Ÿ
2. **æ·»åŠ ** Vercel AI SDK ä½œä¸ºé€‚é…å±‚
3. **é‡‡ç”¨** assistant-ui çš„ UI ç»„ä»¶å’Œæœ€ä½³å®è·µ
4. **æ¸è¿›å¼** è¿ç§»ï¼Œé™ä½é£é™©

è¿™æ ·æ—¢èƒ½ä¿æŒç°æœ‰åŠŸèƒ½ï¼Œåˆèƒ½è·å¾—æ›´å¥½çš„ UI/UX å’Œç¤¾åŒºæ”¯æŒã€‚

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0
**æ›´æ–°æ—¥æœŸ**: 2026-02-02
**ä½œè€…**: Claude (AI Assistant)
